
R version 3.1.0 (2014-04-10) -- "Spring Dance"
Copyright (C) 2014 The R Foundation for Statistical Computing
Platform: x86_64-unknown-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ##ttest.r
> ##2014-07-21 dmontaner@cipf.es
> ##Statistical testing with R: Student's t-test
> ## <http://en.wikipedia.org/wiki/T_test>
> ## <http://es.wikipedia.org/wiki/Prueba_t_de_Student>
> 
> ## CLEAN THE WORKING ENVIRONMENT
> rm (list = ls ())
> options (width = 200)
> 
> ## SIMULATE NORMAL DATA
> N <- 1000
> media <- 0
> desviacion <- 1
> 
> N
[1] 1000
> media
[1] 0
> desviacion
[1] 1
> 
> rnorm (n = N, mean = media, sd = desviacion)
   [1] -1.3817687802  0.2755603878  2.3820073522  0.7498627710 -0.2235387453  0.2087610080 -0.1759987073 -0.9743397819  0.4101024929 -0.6295448874  0.3152408301  0.3902356924 -1.7312422554
  [14]  0.5874217469 -0.9917313048 -0.5136382215 -1.9684843547  0.4475098852  0.9269331114  0.7816437012 -0.4929812768  1.3707827054 -0.6218226218 -0.0093966836  1.4641984035  0.3069672383
  [27]  0.9976756765 -1.4393586545  0.6190816838 -0.1770794555  1.8799399244 -0.3512370744  0.3707597321  0.8806679164 -1.0405557730  1.1516833384 -0.2742599399 -1.3024659686  1.5055175676
  [40] -1.7514124385  0.4806180119  0.9062669227  1.1256432434  0.6141399397  0.2160913257 -0.4304362823  0.6003037453 -0.7447862012  1.0426742099 -0.6308526471  0.1088060676 -0.6750217638
  [53] -0.3285383746  0.9610257168 -1.0697439130  1.3738530524 -0.0877606586 -0.7896757258 -0.3159090289  1.1626921187  0.6913286359  1.2315566799 -2.2012518945 -0.9701022448  0.0011284585
  [66]  1.7222064133 -0.3500633036 -0.3815562303 -0.6900932086  0.5731277148  0.3471256797 -1.2407493825  1.7249662457  0.7093843644 -0.6555793216 -0.0972532707 -0.1656678583 -1.0586714366
  [79] -1.3411507602  0.5757386700 -1.2033415320  0.6132031921  0.8292628101  1.0219848441 -0.7304720338 -1.3465385122  0.2458295743  0.9795670328 -0.4581438169 -0.0334072320  0.8253092994
  [92] -1.9460843881 -0.3811763206  0.2055605389 -1.2792996962 -1.6932547234 -0.0491087626 -1.0404246209 -0.5734423172 -0.1472607985 -1.0297203412 -2.4110975129 -2.1349660997  0.1753626259
 [105]  1.7388002760  0.0742912340 -0.6022137587 -0.2103633001  0.5868596730  1.0945491788 -0.7083839675  0.2080624820  0.3356662830 -0.6331509114  1.1959167313 -0.5445725872  1.4105457996
 [118]  0.8193134523  2.9972521435  0.8853770040 -0.6321252114  0.7403113622  0.9524402177  0.9813296870 -0.1212049625  0.7265021432  0.3351085065  1.3334721322 -0.8139678462  0.5685497855
 [131]  0.0692558046  1.0763889944  0.3926520021  1.9346908223 -1.0844914746 -0.6567702815  0.1097107276  0.9523840587  0.9317551878  0.9463465060 -1.1468619520 -0.0027491600  0.1623007369
 [144] -1.7463931714  0.1313596770 -0.0323287788 -1.9338124942  1.1512366162 -0.2837984256  1.7718332676  1.1546198658  0.9474612394 -1.6446091029  2.2459115267 -0.3455749615  0.6281864849
 [157]  0.8166040137 -0.4455514118 -0.3634086663 -0.3883328721  1.3046253355 -1.4371249733  0.8534304867  1.3739221744  0.9726013916 -0.9005358701  0.2989683818  0.0172580087 -0.1127934904
 [170]  0.0352479581  0.6473078990 -0.5823606596  0.0529678864 -0.2526684123  0.5099947396  0.2945236554 -0.4868960723  0.0125983394  0.8806681056 -0.0798499537 -0.3118335030  1.3144905819
 [183]  0.6355320344 -1.2794090344  0.3786057992 -0.3337873101 -0.5996192698  0.3547282292  1.2032415164  0.1712837565  0.0767393555 -1.4496034010 -0.8089320470 -1.1411686380  0.9957681305
 [196] -0.2839897289 -0.0852559729 -0.7512417289 -0.4944529650 -1.1293764800 -1.3548291706 -1.4834012627 -1.1012369669 -0.3729210882  0.0611814496 -0.7362280031 -0.4589769200 -0.9024163157
 [209] -0.5265533687  0.7497417766 -1.5109222991  0.1112697849  0.1576089864 -1.9744889095  0.7803970074 -0.3853554949 -0.4574809395 -0.1172837803  1.9169577719 -0.6831203436  0.0988903513
 [222]  1.1890827560  0.1471013179 -0.4741973485 -0.2636051080 -0.1011718831  1.0740095470 -0.5193246735 -0.2099105358 -0.0952760241 -1.2863703308 -1.7666347090  0.9760362006 -0.1588712600
 [235] -2.1232558634 -0.3337023934  0.5555632469 -1.0902525387  1.2229136335  0.2216281502  2.8184099976 -0.4746665735 -0.8784406162 -0.5777541318  1.3126099052 -0.9911934304  0.3022135765
 [248] -0.2545678814  0.3299618698 -0.8806118848  0.3916138642 -0.8248444747 -0.8772707068 -0.8351262262  0.6356940948  0.4788333432  0.5359705252  1.6033220861 -0.0256541328 -0.2656646861
 [261]  0.5926363224  0.1649071900 -1.4581062812 -0.5409077122  1.9072594802  0.1689885890  0.7025359491 -1.0610254452 -0.2623849330  2.4764732430  0.0630297169 -1.1900475487  0.2001833998
 [274] -3.6117151250 -1.1953822795 -0.8344246529 -2.3991393149 -0.7036863897  1.8502227754 -1.3638278158 -1.0780256265 -0.1599231806  0.9430352715  0.2415426325 -0.9418104943  0.5247257142
 [287]  0.1898639559  0.9699336489 -0.5158687338  0.2976126215 -0.1628016688 -1.2537792763 -1.1319983864  0.7997533711 -0.1767584831 -0.2016808338  0.2620837936 -2.2557758029 -0.0899451589
 [300] -0.7074333057 -0.1602834962 -0.3500532496 -1.0624663696  1.4400070264 -0.9371502474  0.7832565311  0.0425864601  1.0063334470 -0.7658811444  0.1243819790 -0.4263719255 -0.6011441335
 [313]  0.8385160943 -0.5707362684 -0.6845863992 -1.2775431229  0.0427601020 -0.4289501112  1.4820423734 -1.6033169691 -0.6629788217 -0.2236580456 -1.2097680972  0.8560691617 -0.2934673773
 [326] -0.1625551867  1.4275189592 -0.7857712954  0.6877726708  0.5548073393  0.7639943733  0.2094275552  0.1121258024 -0.0392640267 -1.8422293533 -0.0941494757 -0.1575383206  0.3056220037
 [339]  1.8957956205  0.2753245350 -1.6887181478 -1.0642887817  0.4279982664  0.8073281904 -0.0403936345 -0.3703061039 -1.0578399014  0.3441580613 -0.1562547924  0.1521274051 -1.5219755409
 [352] -0.6450382802  2.2794580546  0.9223591168 -1.1455687987 -1.0251457505  0.1445382720  0.0475110772  2.6097455070  0.8752589135 -1.3075945447  0.7609629184 -1.2039238832  0.1375612918
 [365] -0.9557178944  0.7029902559 -0.5721764834  1.1323926877  0.7667662174 -2.9707685406 -0.7551883345 -0.1382639818  0.4272887747  0.4437807632  0.1100671625 -0.0791466263  1.4515327010
 [378] -0.1495007973  0.5462160663 -1.8030843669  1.2336649360 -0.1291342586  0.0593204851 -1.1715339690 -0.1104242447  0.2277141938  0.2525609496  0.7197490345  0.4920661723 -0.2463564140
 [391]  1.3207868050  1.6202375619  0.1468168854 -0.5436735796  0.8626416659 -1.5339910151 -2.3700946621  1.6346745645 -0.7998588219 -0.6686843948 -0.6232107769  1.0564176273 -0.1711319742
 [404] -0.3232163447  1.0026321376 -0.6397576127 -1.5896027973 -1.2677925152  0.7613485708  1.6289766980  0.4088053446 -0.8413199213  0.8974963250  0.3314150882  0.8423944060  0.9376206614
 [417] -0.5894620734 -0.3819147820 -0.5241675173 -1.2651157731  1.3111862644  1.2956920763 -0.4485963620 -0.0264602078 -0.8913458119 -0.3966744716  0.9083233995 -1.4961456315 -1.8310669950
 [430] -0.5573142186  0.1418909763  0.5534710512  0.1707225351  0.4223291703 -0.3752689634  1.3435544223 -0.3022100110  1.6387137276  1.7896776430 -1.2903204859  0.8009905860  0.9014132704
 [443] -1.6594185557 -0.2694304325 -0.6725540442 -0.1361519304 -1.0201576693  0.2321535581 -1.4444381543 -1.0620245979  0.7047112258  0.3936946893 -0.6463379509  0.2239106441  1.1166467785
 [456] -0.2490148025  1.3512005932 -0.7863457206 -0.1075864219 -1.7150872626 -0.3142901890 -0.8247096112  0.5342421095  1.7857127352 -0.8348844226 -0.7388587460  0.2940520172  1.5768567569
 [469] -0.1276034041  1.0811022021  0.1216786509 -1.5279488773  0.3326005294 -0.6924421326 -0.1930979024  0.6570740235  1.4973995944 -0.5636081242  0.4083456417 -1.9450525886 -0.5161368564
 [482] -1.4673676849 -1.8632927281 -0.3654324737 -0.1850205267 -0.1915836478  0.6995578492  1.1965694975  0.7332632769 -0.6286130033 -0.8412259902 -1.0012209906 -1.3448408053 -0.9643819749
 [495] -0.1427150607  0.2760144555  0.2917142026  1.4909808370  0.5298509777  0.4370347947 -0.4253771519 -0.6938734252  0.1196670520 -0.5544740245 -0.1509724820  1.5084766676 -1.0213605295
 [508] -0.2646479942  0.0634448240 -2.3704835671 -1.1768585546 -1.0377170907  0.4395358442 -1.3604051412 -0.6367592278  2.7033757564  0.9278320921  0.4742316543  0.5938527751  2.7140237132
 [521] -0.2843471624 -0.7610610528 -1.0404906529  1.0803867361 -0.0501948068 -0.6606142353 -0.1857648613  0.4380254418  0.5434471431  0.1520958676 -0.3440176425 -0.0912011298 -0.6333044228
 [534] -0.3931697767 -0.4807061493  0.4219118693  0.2612332941  0.0910972518 -1.5413143517 -1.2652788141 -0.7777567680  1.6284906589 -0.8099367445 -0.1076139121  0.0135725727  0.3394865373
 [547] -1.1454865656 -0.0890691941  0.1595782282  1.1091976283  0.3008702482 -0.8274538478 -0.5733940027  0.1306555300  0.2831041019  1.0627079166  0.4298852104 -1.2434825010 -0.1488039133
 [560]  0.0988684232  2.8653091505 -0.3522942094 -0.7489973066  0.6062305655  0.3761939420 -0.4129303211 -0.9279225285  0.8426480226  0.4616710313 -1.1993551818  0.8368529761  1.1749115542
 [573]  1.0706910703  0.1842886786  0.0664612530  0.4825065577 -1.7420310647  0.5642463171 -0.1093523006 -0.4016455488 -0.8440736282 -1.2551776913  0.2900375472  1.4249148631 -1.8342077421
 [586]  0.3019858201  1.1023030043  1.7839990782  0.2414151032 -0.2789844197 -1.2554580225  0.4853642512 -0.6122907074 -0.6330577747  0.3136146690  0.0365233490  0.9627288198 -1.1024694673
 [599] -1.3143036304  0.0268298900  0.3391524424 -1.4885419276  0.0401295609  0.4855235917  0.5213492611 -1.0077034692 -1.2843546235  1.6476682185 -2.1656236857  0.6990039039 -1.1296116576
 [612] -1.5416632392 -0.7553925840  1.6713768285 -0.2964279281 -0.8840365826  0.4125516650 -0.1458349192  1.2312103288 -1.3277130842  0.8199795635  1.0002763143  1.5076412252  0.2197775739
 [625]  0.7443773048 -0.8952176206 -0.2345988762 -0.1572130748 -1.8701336085  0.0044751095 -0.9926931316 -0.0798721347 -0.4715236399 -1.7084271487  0.7022998603  0.3796473661 -0.3713170896
 [638] -0.6714682737  0.4255698652  0.9676685877 -0.2597203702  1.1852305459  1.6210977121  1.2136917612 -0.8422324651 -1.6672745771  0.2704144767  1.2651266501 -1.4520355102  1.1405132075
 [651] -0.2680676568  1.1783956156  1.4062821443  0.5863086995  0.5219025433 -1.4017284846 -0.8466210956  1.2443598218  0.1680592564 -0.0015864211 -1.1736918986  0.4569198030 -0.9076394609
 [664] -0.4613040377 -0.0100961394  0.0277525482 -0.2499855989  1.1100859632 -0.7783885323  0.3445172929  0.2826518206 -1.7916552434  2.2448615177 -0.9373188750 -1.4913881772 -0.3460239782
 [677] -0.0369846437 -0.2475504937 -1.4520194146  0.8692699469 -0.0092808113 -0.4710556451  0.7457763664  1.5274360140 -1.3121089606 -0.2535966839 -0.5211405685 -0.7379061472  0.7242863264
 [690]  0.5287881556 -2.1238213614 -0.1204520957  1.5434860335  0.2588973800  1.5016933063  0.4821051573 -0.7524507379  0.3051347880 -0.6726098065  0.5667779891 -0.4324783233  0.9180717659
 [703] -1.1592618674  0.7416388928  0.6638273712 -1.1451695648  0.8529532752 -0.2813871664  2.0059135148  1.4597131762  0.5767738155  0.3256498714  0.3684719609  1.1753955979  0.5775780097
 [716] -1.0613666259  0.4102153866  0.5502302989  0.0266772782  0.1434326060 -1.4188504246  0.9219821353 -0.1169969516 -0.2286289132 -0.4608299064  1.2050039743  0.7189614781  1.1495665975
 [729]  0.8019671437  1.2176555216 -0.3356572160 -0.4577052751  0.8119848698  0.8134532460  0.5015937706 -0.2060479162  0.9457413595 -0.5231096020 -1.0483174727  1.4960260092  0.2154476368
 [742]  1.7571578749  0.1725070083  1.2654715663  0.0859505586 -0.8980745449  0.5375515677 -0.4168575638 -0.4741221174 -0.4385568317 -0.3646260850  1.5898155995 -0.2795881817  0.6216550743
 [755] -0.3145852311  0.2638832481 -0.3351450405  0.5622635709 -0.3872167143  0.9116909529  0.2686362635  1.3367396377 -0.8011965299 -0.6884716728 -0.2686954812  2.9002367835  0.4391461887
 [768] -0.8865738443 -1.4558190436 -0.3816987517  0.2066750945  0.2845251817 -1.7772218874 -0.1205315414  1.0089341509  1.3034766013  0.1333991033 -0.0743877400  0.1493769605 -0.3988456704
 [781] -1.9810214273  0.1449488563 -1.1862964315 -1.5861953053  0.4803236793  0.1154778014 -0.1378811326  1.2231484818  0.0026673231 -1.0402341923  0.8077494457  0.4617317042 -0.3163025897
 [794] -0.5893328911 -0.6439428929 -1.6085736761 -0.3289335045 -0.3161381048  0.3185677190 -0.9649549519  0.2751987307 -0.4352056255  0.6921675371 -0.2917017119 -0.8670719724 -0.6330633855
 [807] -0.2729713044 -0.5558758071  1.5413517306 -0.1722531425 -0.6493709028 -0.1972667012  0.0206562654 -0.2565367112  1.2586496249 -2.2450997329  0.5859249655  0.5796129222  0.3481433523
 [820]  2.1989097589 -1.3708492461 -0.8377017335 -0.2347592427  0.8125082724 -0.2805378935 -2.6136054705  0.1194345169  0.0670401071 -0.5619570235 -0.1983078129  1.6135278135  0.1177659282
 [833]  1.6408630582 -0.6938011259 -0.8529755430  0.4771453156 -0.7631202133 -0.2487957714  0.7611221399 -0.0001247794 -0.3300149401 -0.5614980917  0.8686685264 -0.3475464788 -1.7161487646
 [846]  1.4465481754  0.2955533832 -0.5458765256  0.1819606504 -1.6139708751 -1.0880199219 -0.2627309077  0.4264302704  0.8533452541 -0.5210643682 -0.1214883618 -1.0662991873 -0.5635203162
 [859]  1.5241149163  0.6256628425  0.9953066562 -0.3824905249  0.5512135959  0.4476384686  0.1584451063  0.2746780277  0.6613279843  0.2896550920 -0.2553612726 -1.0966151456 -0.3988672095
 [872] -2.4689431179  1.0496922776 -0.6421012527 -2.2521146291 -1.0417219849  1.4883191151  0.5524758708  0.7599892994  0.6399188967 -1.2370324611  0.1496463048  0.9204200186 -1.2848976300
 [885]  0.5443286491 -1.2715026694 -2.6522543566  0.1574510620 -0.9338025558 -0.0654648315  1.0589674662  1.2290132605 -0.4450194486  0.0096240927 -0.7942992963  0.4397009506  0.4690024731
 [898]  0.3882475304  1.4592219794  0.4830550343  0.7528604007 -0.2436309674 -0.0674116225  1.6418358616  1.4757763680 -0.1481310713 -0.5385711574 -0.5071405223 -0.2838644627 -0.0003861373
 [911] -0.7953051172  0.2769131223  0.0274107904 -1.0332911727 -1.3782485864 -0.5590964373  0.7004957898 -0.1806422213  0.8812729109 -1.3680903940 -0.7007874077  0.0997046417 -0.3435532317
 [924]  0.1753849309 -0.8433879313  0.7386419586 -3.3014137353  1.1961811700 -1.1930850768  0.1142513445  0.4792299953 -0.3118767064  0.9948107156 -0.1922149007  0.8077985970  0.2280518706
 [937]  0.8400040972 -1.1413958717 -0.1028661923  0.9156204200 -0.9379851062 -1.0136801479 -0.3800360996  0.6526077198  2.2638003331 -0.6474043114 -0.7653654364  1.6682205393  0.4459886173
 [950]  1.3107269513  0.9068141582 -0.6706633239 -0.2414727152  1.3005945260  1.3681305284 -1.3859689818 -0.0219078188 -1.7566202489 -0.3698242002 -1.1007955407 -1.7596548238  0.2549748264
 [963] -0.1738235127  0.2224046887 -0.8200116373 -1.5515943014  0.0784155924 -0.4888849833  0.7778906131  0.3060838612  0.3661009395 -2.8830120296 -1.1546818871 -1.2060662750 -1.6814132470
 [976] -0.5311985676 -0.4656072938  0.4604653000 -0.0731086053 -1.5185606726  0.1319528422 -0.5148018305  0.4161114426  0.0353592449  1.5329252645 -1.8482807981 -0.9374321428  0.9386376810
 [989] -0.9815604252 -1.2330445523 -0.4853348199 -0.7637046479  0.0520636469  0.4617338322 -1.0939674671  0.8320929194  0.4399304957 -1.7732465446 -1.1358056394 -1.5062933603
> 
> ## KEEP THE DATA
> datos0 <- rnorm (n = N, mean = media, sd = desviacion)
> 
> ## DISTRIBUTION
> hist (datos0)
> 
> ## DENSITY
> hist (datos0, freq = FALSE)
> lines (density (datos0))
> 
> plot (density (datos0))
> 
> 
> ## LOOP OVER THE MEAN VALUES
> plot (density (datos0), xlim = c (-4,15), lwd = 3)
> for (i in 1:10) {
+     print (i)
+     datos <- rnorm (n = N, mean = i, sd = desviacion)    
+     lines (density (datos), col = i)
+     readline ("press intro: ")
+ }
[1] 1
press intro: 
[1] 2
press intro: 
[1] 3
press intro: 
[1] 4
press intro: 
[1] 5
press intro: 
[1] 6
press intro: 
[1] 7
press intro: 
[1] 8
press intro: 
[1] 9
press intro: 
[1] 10
press intro: 
> 
> 
> ## LOOP OVER THE DEVIATION VALUES
> plot (density (datos0), xlim = c (-4,7), ylim = c(0, 10), lwd = 3)
> for (j in 1:10) {
+     d <- 1/j
+     print (d)
+     datos <- rnorm (n = N, mean = 2, sd = d)    
+     lines (density (datos), col = j+1)
+     readline ("press intro: ")
+ }
[1] 1
press intro: 
[1] 0.5
press intro: 
[1] 0.3333333
press intro: 
[1] 0.25
press intro: 
[1] 0.2
press intro: 
[1] 0.1666667
press intro: 
[1] 0.1428571
press intro: 
[1] 0.125
press intro: 
[1] 0.1111111
press intro: 
[1] 0.1
press intro: 
> 
> ################################################################################
> 
> ## P-VALUE
> t.test (x = datos, y = datos0)

	Welch Two Sample t-test

data:  datos and datos0
t = 62.4585, df = 1018.321, p-value < 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 1.954414 2.081203
sample estimates:
  mean of x   mean of y 
 2.00345164 -0.01435689 

> t.test (x = datos, y = datos0)$p.value
[1] 0
> 
> ## P-VALUE changes with the mean values
> for (i in 1:10) {
+     i <- i/50
+     cat ("mean", i, fill = TRUE)
+     datos <- rnorm (n = N, mean = i, sd = desviacion)    
+     ##
+     p <- t.test (x = datos, y = datos0)$p.value
+     cat ("p-value: ", p, fill = TRUE)
+     cat ("\n")
+ }
mean 0.02
p-value:  0.2878842

mean 0.04
p-value:  0.1395558

mean 0.06
p-value:  0.09303284

mean 0.08
p-value:  0.03478169

mean 0.1
p-value:  0.001473554

mean 0.12
p-value:  0.09317319

mean 0.14
p-value:  1.484976e-05

mean 0.16
p-value:  1.645748e-07

mean 0.18
p-value:  8.610082e-06

mean 0.2
p-value:  1.274247e-05

> 
> 
> ## P-VALUE changes with the standard deviation
> for (j in 1:10) {
+     d <- 1/j
+     cat ("sd", d, fill = TRUE)
+     datos <- rnorm (n = N, mean = 1, sd = d)
+     ##
+     p <- t.test (x = datos, y = datos0)$p.value
+     cat ("p-value: ", p, fill = TRUE)
+     cat ("\n")
+ }
sd 1
p-value:  2.863147e-98

sd 0.5
p-value:  3.328977e-139

sd 0.3333333
p-value:  8.221021e-147

sd 0.25
p-value:  6.513352e-152

sd 0.2
p-value:  2.418612e-150

sd 0.1666667
p-value:  2.366248e-151

sd 0.1428571
p-value:  1.646443e-150

sd 0.125
p-value:  7.275797e-154

sd 0.1111111
p-value:  2.655539e-153

sd 0.1
p-value:  7.515246e-154

> 
> 
> proc.time()
   user  system elapsed 
  0.274   0.016   0.270 
